<!doctype html>
<html lang="">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>cp</title>

    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    <!-- Place favicon.ico in the root directory -->

    <!-- build:css styles/vendor.css -->
    <!-- bower:css -->
    <link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.css" />
    <!-- endbower -->
    <!-- endbuild -->

    <!-- build:css styles/main.css -->
    <link rel="stylesheet" href="styles/main.css">
    <!-- endbuild -->

  </head>
  <body>


  <div class="container-fluid">
     <div class="center1">
       <div class="top4">
         <a >根 据 您 所 填 的 信 息 ，为 您 匹 配 的 cp 是：</a>
       </div>
       <div >
         <p>Hi~</p>
         <p>我是</p>
       </div>
       <div id="touxiang"></div>
       <div id="xingming"><p>嗯哼</p></div>
       <div class="aihao" >
           TA的兴趣爱好：
           <div id="aihao_1">
             打篮球
           </div>
       </div>
       <div class="kaishi1" type="button" >
           <p>开始任务</p>
       </div>
       <div class="kaishi2" >
         <p>残忍拒绝</p>
       </div>
     </div>


  </div>

    <script src="/bower_components/jquery/dist/jquery.js"></script>
    <script src="scripts/main.js"></script>
  <script>
    //获取用户的cp
    window.onload=function()
    {
      var url = "http://localhost:8084/leinuo/weekcp/match/"+sessionStorage.userid+"/getMatchByUserId?Authorization=" +sessionStorage.vq;
      fetch(url).then(response => response.json())
        .then(data => {if(data.success == 1)
        {
           console.log(data);
           if(data.data.cpidLeft == sessionStorage.userid)
           {
             sessionStorage.cpuserid = data.data.cpidRight;
           }
           else{
             sessionStorage.cpuserid = data.data.cpidLeft;
           }
           render();          //根据cpuserid获取用户cp的信息以更改页面内容
        }})
        .catch(e => console.log("Oops, error", e))
    }

    function render() {
      var url2 = "http://localhost:8084/leinuo/weekcp/user/"+sessionStorage.cpuserid+"/getUserByYibanId?"+"Authorization="+sessionStorage.vq;
      fetch(url2).then(response => response.json())
        .then(data => {
          console.log(data);
          if (data.success == 1) {
            console.log("获取用户的cp信息成功！");
            console.log(data.data);
            sessionStorage.usercp = JSON.stringify(data.data); //将当前用户cp对象以字符串形式存储到web中
          }
        })
        .catch(e => console.log("Oops, error", e))

        //更改页面内容
        var cp = JSON.parse(sessionStorage.usercp);
        $("#xingming").html(cp.name);
        $("#aihao_1").html(cp.hobby);
        var imgurl = cp.headerImage;
        $("#touxiang").css("background-image","url("+imgurl+")");
    }




  $(".kaishi1").click(function () {
    window.location='43.html';
  })
  $(".kaishi2").click(function () {
    window.location='fail.html';
  })

  </script>
  </body>
</html>
